{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/komba/Gestion-contenu/FRONTEND/app/users/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\ninterface User {\r\n  _id: string;\r\n  username: string;\r\n  email: string;\r\n  role: string;\r\n}\r\n\r\nexport default function UsersPage() {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [updating, setUpdating] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      const res = await axios.get('http://localhost:3003/api/users'); // ← backend NestJS\r\n      setUsers(res.data);\r\n    } catch (err) {\r\n      console.error('Erreur de chargement des utilisateurs', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRoleChange = async (userId: string, newRole: string) => {\r\n    try {\r\n      setUpdating(userId);\r\n      await axios.patch(`http://localhost:3003/api/users/${userId}/role`, {\r\n        role: newRole,\r\n      });\r\n      fetchUsers(); // refresh\r\n    } catch (error) {\r\n      console.error('Erreur de mise à jour du rôle', error);\r\n    } finally {\r\n      setUpdating(null);\r\n    }\r\n  };\r\n\r\n  if (loading) return <p className=\"\">Chargement...</p>;\r\n\r\n  return (\r\n    <div className=\"w-full h-screen p-6 bg-black text-[#ececec]\">\r\n      <h1 className=\"text-3xl font-bold mb-6\">les utilisateurs et leurs Rôles</h1>\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full border border-black-700 text-left\">\r\n          <thead className=\"bg-black-800 text-white\">\r\n            <tr>\r\n              <th className=\"px-6 py-3 border\">Nom</th>\r\n              <th className=\"px-6 py-3 border\">Email</th>\r\n              <th className=\"px-6 py-3 border\">Rôle</th>\r\n              <th className=\"px-6 py-3 border\">Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"bg-black-900\">\r\n            {users.map((user) => (\r\n              <tr key={user._id} className=\"border-b border-black-700\">\r\n                <td className=\"px-6 py-3\">{user.username}</td>\r\n                <td className=\"px-6 py-3\">{user.email}</td>\r\n                <td className=\"px-6 py-3 capitalize\">{user.role}</td>\r\n                <td className=\"px-6 py-3\">\r\n                  <select\r\n                    value={user.role}\r\n                    onChange={(e) => handleRoleChange(user._id, e.target.value)}\r\n                    disabled={updating === user._id}\r\n                    className=\"px-3 py-1 rounded border bg-black-800 text-white\"\r\n                  >\r\n                    <option  value=\"user\">user</option>\r\n                    <option  value=\"admin\">admin</option>\r\n                    {/* <option  value=\"editor\">editeur</option> */}\r\n                  </select>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAYe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU,EAAE;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAExD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR;IACF,GAAG,EAAE;IAEL,MAAM,aAAa;QACjB,IAAI;YACF,MAAM,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,oCAAoC,mBAAmB;YACnF,SAAS,IAAI,IAAI;QACnB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yCAAyC;QACzD,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,mBAAmB,OAAO,QAAgB;QAC9C,IAAI;YACF,YAAY;YACZ,MAAM,qIAAA,CAAA,UAAK,CAAC,KAAK,CAAC,CAAC,gCAAgC,EAAE,OAAO,KAAK,CAAC,EAAE;gBAClE,MAAM;YACR;YACA,cAAc,UAAU;QAC1B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;QACjD,SAAU;YACR,YAAY;QACd;IACF;IAEA,IAAI,SAAS,qBAAO,8OAAC;QAAE,WAAU;kBAAG;;;;;;IAEpC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA0B;;;;;;0BACxC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAM,WAAU;;sCACf,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAAmB;;;;;;kDACjC,8OAAC;wCAAG,WAAU;kDAAmB;;;;;;kDACjC,8OAAC;wCAAG,WAAU;kDAAmB;;;;;;kDACjC,8OAAC;wCAAG,WAAU;kDAAmB;;;;;;;;;;;;;;;;;sCAGrC,8OAAC;4BAAM,WAAU;sCACd,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC;oCAAkB,WAAU;;sDAC3B,8OAAC;4CAAG,WAAU;sDAAa,KAAK,QAAQ;;;;;;sDACxC,8OAAC;4CAAG,WAAU;sDAAa,KAAK,KAAK;;;;;;sDACrC,8OAAC;4CAAG,WAAU;sDAAwB,KAAK,IAAI;;;;;;sDAC/C,8OAAC;4CAAG,WAAU;sDACZ,cAAA,8OAAC;gDACC,OAAO,KAAK,IAAI;gDAChB,UAAU,CAAC,IAAM,iBAAiB,KAAK,GAAG,EAAE,EAAE,MAAM,CAAC,KAAK;gDAC1D,UAAU,aAAa,KAAK,GAAG;gDAC/B,WAAU;;kEAEV,8OAAC;wDAAQ,OAAM;kEAAO;;;;;;kEACtB,8OAAC;wDAAQ,OAAM;kEAAQ;;;;;;;;;;;;;;;;;;mCAZpB,KAAK,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuB/B","debugId":null}}]
}